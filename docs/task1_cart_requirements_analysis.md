Задание 1. Анализ требований — функционал «Корзина» (интернет-магазин «Петрушка Зелёная»)

Входные данные: фрагмент ТЗ по корзине (пункты 1–13). Ниже:
1) перечислены противоречия/недочёты по пунктам исходного текста,
2) дана исправленная версия фрагмента ТЗ,
3) приведены вопросы к продукт-менеджеру/заказчику.

Ключевые противоречия в исходном фрагменте
- Удаление товара: в одном месте сказано, что количество нельзя снижать ниже 1 и удаление только кнопкой (п.2), а в другом — что удаление происходит при снижении количества до 0 (п.9).
- Цена товара: в одном месте сказано, что цена фиксируется при добавлении и не меняется (п.7), а в другом — что цена должна автоматически обновляться в корзине при изменении в каталоге (п.13).

Выбранные допущения для исправленной версии (чтобы убрать противоречия)
- Удаление: количество позиции 1…10, значение 0 не используется, удаление — отдельной кнопкой.
- Цена: цена в корзине всегда актуальная, берётся из каталога при открытии корзины и при любых изменениях.
- Добавление товара: операция атомарная — либо добавление проходит полностью, либо корзина не меняется и показывается понятная причина.

------------------------------------------------------------

1) Противоречия, недочёты и неполнота (по пунктам исходного ТЗ)

Пункт 1. «Пользователь может добавить в корзину от 1 до 10 единиц одного товара.»
- Неясно, что делать, если этот товар уже есть в корзине: увеличивать количество позиции или добавлять ещё одну строку.
- Не описано, что происходит, если пользователь пытается добавить количество, которое “не помещается” по лимитам (добавлять частично или отклонять целиком).
Как бы исправила:
- Явно задать: в корзине одна позиция на один SKU (товар/вариант), повторное добавление увеличивает количество.
- Описать атомарность операции (полностью добавили или полностью отказали).

Пункт 2. «Пользователь может изменить количество каждого товара в корзине не менее, чем до 1-го. Для удаления используется отдельная кнопка.»
- Этот пункт противоречит пункту 9 (там удаление происходит через уменьшение до 0).
Как бы исправила:
- Выбрать один способ удаления:
  вариант А: количество только 1…10, удаление только кнопкой, 0 недоступен;
  вариант Б: количество 0…10, при 0 позиция удаляется (кнопка “Удалить” тогда либо дублирует, либо не нужна).
(В своей исправленной версии ниже я выбираю вариант А — удаление кнопкой.)

Пункт 3. «В корзине может находиться не более 5 различных товаров.»
- Не определено, что значит “различных”: SKU (с учётом варианта) или карточка товара без вариантов.
- Не описано поведение при попытке добавить 6-й “различный товар” (какое сообщение, что делать пользователю).
Как бы исправила:
- Дать определение термина “различный товар” (рекомендую: SKU).
- Дать отдельное понятное сообщение об ошибке.

Пункт 4. «Суммарное количество всех товаров в корзине не может превышать 20 штук.»
- Не описано, как система себя ведёт при попытке добавить количество, которое превысит 20 (частично/полностью).
- Не описано, что делать при одновременных действиях (две вкладки/два устройства): откуда берётся “истина”.
Как бы исправила:
- Зафиксировать атомарность: если лимит нарушен — операция отклоняется целиком.
- Уточнить правила синхронизации/конкурентных изменений (хотя бы в виде допущения).

Пункт 5. «Товары в корзине могут быть разные.»
- Требование не несёт смысла (это либо очевидно, либо дублирует пункт 3).
Как бы исправила:
- Удалить этот пункт, либо заменить на определение термина “различные товары”.

Пункт 6. «При попытке добавить товар, превышающий лимиты, система показывает сообщение: “Лимит корзины превышен”.»
- Сообщение слишком общее: непонятно, какой лимит нарушен (5 SKU, 20 шт. суммарно, 10 шт. на товар).
Как бы исправила:
- Сделать разные сообщения (или одно, но с конкретикой), например:
  “Нельзя добавить больше 5 разных товаров” / “Нельзя добавить больше 20 товаров суммарно” / “Нельзя добавить больше 10 единиц одного товара”.

Пункт 7. «Цена на продукт фиксируется на момент добавления в корзину и не меняется.»
- Противоречит пункту 13 (там говорится об автообновлении цены в корзине при изменении в каталоге).
Как бы исправила:
- Выбрать одну политику и закрепить её:
  вариант А: цена в корзине всегда актуальная из каталога;
  вариант Б: цена фиксируется (нужно уточнить срок фиксации и правила уведомлений).
(В своей исправленной версии ниже я выбираю вариант А — актуальная цена.)

Пункт 8. «На странице корзины отображается список товаров, их количество, цена за единицу и общая стоимость позиции.»
- Не описаны детали расчётов: округление, формат/валюта, как считается итог корзины.
- Не сказано, что со скидками/доставкой/промокодами (возможно не в рамках задачи, но это нужно обозначить).
Как бы исправила:
- Явно задать формулы и формат отображения цены.
- Сказать, что скидки/доставка/промокоды вне рамок этого фрагмента.

Пункт 9. «Если пользователь уменьшает количество товара до 0, товар удаляется из корзины.»
- Противоречит пункту 2 (там минимум 1 и удаление отдельной кнопкой).
Как бы исправила:
- См. решение по пункту 2 (выбрать один подход).

Пункт 10. «В корзине может быть реклама других продуктов.»
- Слишком общее: где находится блок, в каком виде (карусель/список), сколько элементов, что происходит при пустой корзине.
Как бы исправила:
- Минимально формализовать: размещение блока, формат и правило показа.

Пункт 11. «Реклама товаров в корзине должна быть каждый будний день по утрам и вечерам.»
- Неясно, что имеется в виду: показ блока только утром/вечером или обновление контента утром/вечером.
- Не задано, что такое “утро/вечер” (интервалы) и в каком часовом поясе.
Как бы исправила:
- Определить: это правило показа или правило обновления, задать интервалы и часовой пояс.

Пункт 13. «Если цена на товар изменилась в каталоге, система должна автоматически обновить ее в корзине у всех пользователей.»
- Противоречит пункту 7 (фиксация цены).
- Непонятно, что значит “автоматически”: сразу в фоне у всех или при следующем открытии корзины/пересчёте.
Как бы исправила:
- Если выбираем “актуальную цену”: обновлять при открытии корзины и любых действиях (добавление/изменение/удаление), плюс уведомление “цена изменилась”.
- Если выбираем “фиксированную цену”: этот пункт убрать или заменить на “пересчитать только если фикс-период закончился”.

Отдельные проблемы, которые отсутствуют в исходнике (но нужны для завершённости):
- Пропущен пункт 12 (ошибка нумерации).
- Нет сценария “пустая корзина” (что показываем, есть ли реклама).
- Нет условий по авторизации/сессии: корзина гостевая или только для авторизованных, что делать при входе (слияние корзин).
- Не описаны ошибки/сообщения для каждого лимита отдельно (только общее сообщение).

------------------------------------------------------------

2) Исправленная версия фрагмента ТЗ (предложение)

Важно: ниже я фиксирую допущения, чтобы убрать противоречия:
- политика цены: цена в корзине всегда актуальная из каталога;
- количество позиции: 1…10, удаление отдельной кнопкой, “0” не используется;
- добавление товара — атомарное (или полностью, или отказ без изменений).

Термины
1. Товар (SKU) — конкретная позиция каталога с учётом варианта (вес/объём/цвет и т.п.).
2. Позиция в корзине — (SKU, количество). В корзине не бывает двух позиций с одинаковым SKU.

Лимиты
1. Количество одного SKU: от 1 до 10 включительно.
2. Количество разных SKU в корзине: не более 5.
3. Суммарное количество всех единиц товаров в корзине: не более 20.

Добавление товара
1. Пользователь добавляет SKU в корзину с количеством N, где 1 ≤ N ≤ 10.
2. Если SKU уже есть в корзине, то добавление увеличивает количество позиции: new_qty = current_qty + N.
3. Операция добавления атомарная: если после добавления нарушается хотя бы один лимит — корзина не изменяется.
4. При нарушении лимита показывается конкретное сообщение:
   - “Нельзя добавить больше 10 единиц одного товара” (если превышен лимит по SKU),
   - “Нельзя добавить больше 5 разных товаров” (если превышен лимит разных SKU),
   - “Нельзя добавить больше 20 товаров суммарно” (если превышен суммарный лимит).

Изменение количества и удаление
1. На странице корзины для каждой позиции доступны:
   - увеличение количества (с проверкой лимитов),
   - уменьшение количества (не ниже 1),
   - удаление позиции кнопкой “Удалить”.
2. Значение 0 не используется.

Отображение корзины
1. Для каждой позиции отображаются: наименование, количество, цена за единицу, стоимость позиции.
2. Стоимость позиции = количество * цена за единицу.
3. Итог корзины = сумма стоимостей всех позиций.
4. Формат цены: 2 знака после запятой (например, 123.45). Валюта — как в каталоге (нужно уточнить, если важно).
5. Скидки/доставка/промокоды в рамках данного фрагмента не рассматриваются.

Политика цены
1. Цена в корзине всегда актуальная, берётся из каталога.
2. При открытии корзины и после любого изменения (добавление/изменение количества/удаление) система получает актуальные цены из каталога и пересчитывает суммы.
3. Если цена изменилась, система показывает уведомление “Цена на некоторые товары изменилась” (без блокировки действий).

Пустая корзина
1. Если позиций нет — показывается “Корзина пуста” + кнопка перехода в каталог.
2. Рекламный блок (если включён) отображается ниже этого состояния.

Реклама в корзине (минимальная формализация)
1. На странице корзины есть блок “Рекомендуем” ниже списка товаров (или ниже “Корзина пуста”).
2. Контент блока обновляется два раза в будние дни: утром и вечером.
3. Интервалы “утро/вечер” и часовой пояс должны быть явно заданы (см. вопросы ниже).
4. Рекламный блок не влияет на лимиты корзины и итоговую сумму.

------------------------------------------------------------

3) Вопросы к продукт-менеджеру / бизнес-заказчику

Про товары и лимиты
1. “Различный товар” — это SKU (вариант) или карточка товара без учёта вариантов?
2. Если лимит почти достигнут и добавляется больше, чем “влезает”: добавляем частично или полностью отклоняем?
3. Лимиты 5 SKU / 20 шт. — одинаковые для гостя и авторизованного пользователя?
4. Что считается источником истины при одновременных изменениях (две вкладки/два устройства)?

Про цену
5. Верная политика цены: фиксировать при добавлении или всегда актуальная из каталога?
6. Если цена фиксируется: на какой срок (до оформления / на N минут) и нужно ли уведомление о смене цены?
7. Что делать, если товар стал недоступен/закончился: блокировать оформление, скрывать, помечать, удалять из корзины?

Про отображение и UX
8. Можно ли вводить количество вручную, или только кнопки +/-?
9. Нужны ли разные тексты ошибок для каждого лимита (рекомендую да), или достаточно общего сообщения?

Про рекламу
10. “Утром и вечером” — это про показ блока или про обновление контента?
11. Какие интервалы считать “утро/вечер” и в каком часовом поясе?
12. Как подбираются рекомендации: фиксированный список, по истории, по категории, A/B?
13. Сколько товаров показываем и в каком формате (карусель/список)? Что при пустой корзине?

Про авторизацию
14. Корзина доступна гостю?
15. Если пользователь добавлял как гость и затем вошёл в аккаунт — как объединяем корзины (слияние/замена/выбор)?
